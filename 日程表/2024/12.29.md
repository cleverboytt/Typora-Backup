# 安排

- [ ] C++学习 42/94

- [ ] webserver 项目

  ---

  

👇【45】C++ 复制与拷贝构造函数

拷贝复制是非常有用的东西，可以让程序按照我们想要的方式工作，但另一方面，不必要的复制是不好的，我们要尽量避免这种情况，因为会浪费性能， 

```C++
#include<iostream>
#include<string>
#include <string.h>

class String{
private:
    char* m_Buffer;
    unsigned int m_Size;
public:
    String(const char* string){
        m_Size=strlen(string);
        m_Buffer=new char[m_Size+1];
        memcpy(m_Buffer, string, m_Size+1);
    }
    ~String(){
        delete[] m_Buffer;
    }
    friend std::ostream& operator<<(std::ostream& stream, const String& string);
};
 
 std::ostream& operator<<(std::ostream& stream, const String& string){
    stream<<string.m_Buffer;
    return stream;
 }

 int main(){
    String string="Taojiachen"; 
    std::cout<<string<<std::endl;
    std::cin.get();
 }
```

 深拷贝、浅拷贝，没听懂 qaq

---

👇【46】C++ 中的箭头

```C++
#include<iostream>
#include "string.h"

class Entity{
public:
    void Print() const{
        std::cout<<"Hello!"<<std::endl;
    }
};

class ScopedPtr{
private:
    Entity* m_Obj;
public:
    ScopedPtr(Entity* entity)
        :m_Obj(entity){}
    ~ScopedPtr(){
        delete m_Obj; 
    }
    Entity* operator->(){
        return m_Obj;
    }
};

int main(){
    Entity e ; 
    e.Print();
    Entity* ptr = &e;
    // Entity& entity=*ptr;
    // entity.Print();
    // (*ptr).Print() ;
    ptr->Print();

    ScopedPtr entity = new Entity();
    entity->Print();
    std::cin.get();
}
```

以上是一个箭头操作符的例子。

如何使用箭头操作符，来获取内存中某个成员变量的偏移量？

```
#include<iostream>
#include "string.h"

struct Vector3{
    float x,y,z;
};

int main(){
    int offset = (int)&((Vector3*)0)->x;
    int offset2 = (int)&((Vector3*)0)->y;
    int offset3 = (int)&((Vector3*)0)->z;
    std::cout << offset << std::endl;
    std::cout << offset2 << std::endl;
    std::cout << offset3 << std::endl;
    std::cin.get();
}
```

- `(Vector3*)0` 将整数 `0` 转换为 [Vector3](vscode-file://vscode-app/d:/Microsoft VS Code/resources/app/out/vs/code/electron-sandbox/workbench/workbench.html) 类型的空指针。
- `((Vector3*)0)->x` 通过空指针访问 `x` 成员。
- `&((Vector3*)0)->x` 获取 `x` 成员的地址，这实际上是计算 `x` 成员相对于结构体起始地址的偏移量。
- `(int)&((Vector3*)0)->x` 将偏移量转换为整数，并赋值给 [offset](vscode-file://vscode-app/d:/Microsoft VS Code/resources/app/out/vs/code/electron-sandbox/workbench/workbench.html) 变量。

---

👇【47】C++ 中的动态数组

